@page
@model app.WEB.Pages.VendingMachinesModel
@using Microsoft.Extensions.Localization
@inject IStringLocalizer<app.WEB.SharedResource> L
@{
    ViewData["Title"] = L["MenuMachines"];
}

<h1 class="mb-3">@L["UploadTitle"]</h1>
<p class="text-muted">@L["UploadHint"]</p>
<ul class="text-muted">
    <li>Обязательные колонки: Name, ModelId, CompanyId, Address, Place, InventoryNumber</li>
    <li>Опционально: SerialNumber</li>
</ul>

<form method="post" enctype="multipart/form-data">
    <div class="mb-3">
        <input type="file" name="UploadFile" class="form-control" />
    </div>
    <button type="submit" class="btn btn-primary">@L["UploadButton"]</button>
</form>

@if (!string.IsNullOrWhiteSpace(Model.Message))
{
    <div class="alert alert-info mt-3">@Model.Message</div>
}

@if (Model.TotalCount > 0)
{
    <div class="mt-3">
        <strong>@L["ResultsTitle"]:</strong>
        <div>Всего строк: @Model.TotalCount</div>
        <div>Успешно: @Model.SuccessCount</div>
        <div>Ошибок: @Model.ErrorCount</div>
    </div>
}

@if (Model.Errors.Count > 0)
{
    <table class="table table-sm table-bordered mt-3">
        <thead>
            <tr>
                <th>Строка</th>
                <th>Ошибка</th>
            </tr>
        </thead>
        <tbody>
        @foreach (var err in Model.Errors)
        {
            <tr>
                <td>@err.RowNumber</td>
                <td>@err.Message</td>
            </tr>
        }
        </tbody>
    </table>
}
